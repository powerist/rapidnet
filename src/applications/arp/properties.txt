ARP
---

1. Forall: receive a ARP response for IP A -> have sent a broadcast ARP request message for IP A. 

forall Host IP_A Mac_A DstIP DstMac(
	arpReply(@Host, IP_A, Mac_A, DstIP, DstMac)
	->
	exists SrcIP, SrcMac (
		arpRequest(@Host, SrcIp, SrcMac, IP_A, Mac_A),
	)
)

2. Forall: Send a broadcast ARP message for IP A -> no entry that maps IP A to a MAC address

forall Switch Controller Port SrcMac SrcIP Mac_A IP_A (
	packetOut(@Switch, Controller, Port, Pkt), 
	PktLoad1 := f_empty(),
	PktLoad2 := f_prepend(Mac_A, PktLoad1),
	PktLoad3 := f_prepend(IP_A, PktLoad2),
	PktLoad4 := f_prepend(SrcMac, PktLoad3),
	PktLoad5 := f_prepend(SrcIp, PktLoad4),
	PktLoad6 := f_prepend(ARP_REPLY, PktLoad5),
	PktLoad := f_prepend(ARP_TYPE, PktLoad6),
	Pkt1 := f_prepend(DstIp, PktLoad),
	Pkt := f_prepend(SrcIP, Pkt1)
	-> 
	not arpMapping(@Controller, IP_A, Mac_A) 
)




3. Forall: have a map between IP A and MAC M -> either A has responded to an ARP request or A has sent a broadcast ARP request. 


forall Controller, IP_A, Mac_A (
	arpMapping(@Controller, IP_A, Mac_A)
	->
	exists Host, SrcIP, SrcMac, DstIP, DstMac (
		arpReply(@Host, SrcIP, SrcMac, IP_A, Mac_A) //responded to ARP request sent by A
		OR
		arpRequest(@Host, Ip_A, Mac_A, DstIP, DstMac) // A has sent a broadcast request 
	)
)



