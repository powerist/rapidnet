ECA Rule r1Eca0Ins ACTION_REMOTE_SEND<pktToBalance(@SwitchLoadBalancer, SwitchGateway, Client)> :- EVENT_INSERT<pktClient(@SwitchGateway, Client)>, switchConnection(@SwitchGateway, SwitchLoadBalancer).
ECA Rule r1Eca1Ins ACTION_REMOTE_SEND<pktToBalance(@SwitchLoadBalancer, SwitchGateway, Client)> :- EVENT_INSERT<switchConnection(@SwitchGateway, SwitchLoadBalancer)>, pktClient(@SwitchGateway, Client).
ECA Rule r2_eca ACTION_LOCAL_SEND<randomlyObtainedServer(@SwitchLoadBalancer, Server, Client)> :- EVENT_RECV<pktToBalance(@SwitchLoadBalancer, SwitchGateway, Client)>, loadBalancerConnectionToServer(@SwitchLoadBalancer, Server), Value := f_hashIp(Client), Server := 1+ f_modulo(Value, 3).
ECA Rule r3_eca ACTION_REMOTE_SEND<pktServer(@ServerAddr, Client)> :- EVENT_RECV<randomlyObtainedServer(@SwitchLoadBalancer, Server, Client)>, serverMapping(@SwitchLoadBalancer, ServerAddr, Server).
