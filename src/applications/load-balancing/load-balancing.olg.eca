ECA Rule r1Eca0Ins ACTION_REMOTE_SEND<pktToBalance(@SwitchLoadBalancer, SwitchGateway, Client)> :- EVENT_INSERT<pktClient(@SwitchGateway, Client)>, switchConnection(@SwitchGateway, SwitchLoadBalancer).
ECA Rule r1Eca1Ins ACTION_REMOTE_SEND<pktToBalance(@SwitchLoadBalancer, SwitchGateway, Client)> :- EVENT_INSERT<switchConnection(@SwitchGateway, SwitchLoadBalancer)>, pktClient(@SwitchGateway, Client).
ECA Rule r2_eca ACTION_LOCAL_SEND<randomlyObtainedServer(@SwitchLoadBalancer, Server, Client)> :- EVENT_RECV<pktToBalance(@SwitchLoadBalancer, SwitchGateway, Client)>, loadBalancerConnectionToServer(@SwitchLoadBalancer, Server), Server := f_sha1(Client).
ECA Rule r3_eca ACTION_REMOTE_SEND<pktServer(@Server, Client)> :- EVENT_RECV<randomlyObtainedServer(@SwitchLoadBalancer, Server, Client)>.
